{% extends "cluster_app/base.html"%}
{% block content%}
    <section class="home">
        <div class="text">FILES</div>

       
            <div class="panel p1">
              <div class="panel-header">
                 <p>Set :
                        <input  type="radio" name="age" value="All" id="all"/> 
                        <label for="moins15">All</label>
                        <input type="radio" name="age" value="medium15-25" id="medium15-25" /> 
                        <label for="medium15-25"></label>
                        <input class="pseudo" type="text" name="pseudo" id="pseudo" placeholder="ex: 0,1,3:4" size="30" maxlength="10" />
                        <label>As</label>
                        <select class="categorie" name="pays" id="pays">
                            <option value="Categorical">Categorical</option>
                            <option value="Categorical2">Categorical2</option>
                            <option value="Categorical3">Categorical3</option>
                            <option value="Categorical4">Categorical4</option>
                            <option value="Categorical5">Categorical5</option>
                          
                        </select>

                        <input class="apply" type="submit" value="apply" />
                    </p>
                </div>
             </div>

        
        <div class="panel p2">
            <div class="panel-header">
                <h2>Upload de Fichier</h2>
                <!-- Formulaire d'upload de fichier -->
                <input type="file" id="fileUpload" accept=".csv" name="aucun fichier choisi">
                <button onclick="previewFile()" class="btn btn-primary mt-2">Aperçu</button>
               
                </br>
                
                
            </div> 
        </div>

        <br>
        <br>
        <br>


        <br>
        <p>Fonction</p><br>
        <hr>

            <select class="panel p3" name="pays" id="pays">
                <option value="Fonctional">Fonctional</option>
                <option value="Fonctional 2">Fonctional 2</option>
                <option value="Fonctional 3">Fonctional 3</option>
                <option value="Fonctional 4">Fonctional 4</option>
                <option value="Fonctional 5">Fonctional 5</option>
               
            </select> 
           

        <br>
        {%csrf_token%}

        {{form.as_p}}
        <input type="submit" value="Save" class="save">
<br>
<br>

        <div id="fileContent" class="pre-scrollable mt-3">
            <!-- Le contenu du fichier sera affiché ici -->
        </div>
    <div id="python-output" class="alert alert-success">En dessous rajouter la fonction describe() de pandas pour avoir une simple description statistiques </div>

   
</div>

<div class="py-4" id="resultsContent" style="display: none;">
    <h2>Résultats</h2>
    <div id="resultsOutput" class="alert alert-info">Les résultats s'afficheront ici après traitement des données d'entrée.</div>
</div>





    
    
    
    
</main>
</div>

    
<script>
    function showContent(contentId) {
        // Cache tous les contenus
        document.getElementById('overwriteContent').style.display = 'none';
        document.getElementById('filesContent').style.display = 'none';
        document.getElementById('inputContent').style.display = 'none'; 
        document.getElementById('resultsContent').style.display = 'none'; 
        // Affiche le contenu spécifié
        document.getElementById(contentId + 'Content').style.display = 'block';
    }
    
    function previewFile() {
        const file = document.getElementById('fileUpload').files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                displayFileContent(content);
                
                 // on mets à jour le fichier importé
                document.getElementById('dataFile').placeholder = file.name;
                
            };
            reader.readAsText(file);
            
        } else {
            alert("Aucun fichier sélectionné !");
        }
    }
    
    function displayFileContent(content) {
        const lines = content.split('\n').slice(0, 5); // Prend les 5 premières lignes pour simuler .head()
        let htmlContent = '<table class="table"><thead><tr>';
        const headers = lines[0].split(',');
        headers.forEach(header => {
            htmlContent += `<th scope="col">${header.trim()}</th>`;
        });
        htmlContent += '</tr></thead><tbody>';
        lines.slice(1).forEach(line => {
            htmlContent += '<tr>';
            const columns = line.split(',');
            columns.forEach(column => {
                htmlContent += `<td>${column.trim()}</td>`;
            });
            htmlContent += '</tr>';
        });
        htmlContent += '</tbody></table>';
        document.getElementById('fileContent').innerHTML = htmlContent;
    }











    function displayFileContent2(content) {
    const lines = content.split('\n');
    const table = document.createElement('table');
    const tbody = document.createElement('tbody');

    // Assuming the first line contains headers
    const headers = lines[0].split(',');

    // Create table headers
    const headerRow = document.createElement('tr');
    headers.forEach(headerText => {
        const th = document.createElement('th');
        th.textContent = headerText;
        headerRow.appendChild(th);
    });
    tbody.appendChild(headerRow);

    // Populate table with data
    for (let i = 1; i < lines.length; i++) {
        const data = lines[i].split(',');
        if (data.length === headers.length) {
            const row = document.createElement('tr');
            data.forEach(cellText => {
                const td = document.createElement('td');
                td.textContent = cellText;
                row.appendChild(td);
            });
            tbody.appendChild(row);
        }
    }

    table.appendChild(tbody);
    const previewContainer = document.getElementById('fileContent');
    previewContainer.innerHTML = htmlContent; // Clear previous content
   
   
}
    </script>

    </section>
{% endblock content%}